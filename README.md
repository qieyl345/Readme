<h1 align="center">ğŸ  RentVerse (Secured by Vecna)</h1>
<p align="center"><i>A Secure Property Rental Platform with DevSecOps Integration</i></p>

<div align="center">
  <img src="github/assets/LogoUiTM.png" width="400" height="400" alt="UiTM Logo"><br>
  <b>UiTM Tapah</b>
  <br><br>
  <hr width="50%">
  <br>
  <img src="github/assets/logo.png" width="200" height="200" alt="RentVerse Logo"><br>
  <i>Building the Future Through Innovation</i>
  <br><br>
  <hr width="50%">
  <br>
  <img src="github/assets/icon.jpg" width="300" height="300" alt="Team Vecna"><br>
  <b>Team Vecna</b>
</div>

---

## ğŸ“‹ Challenge Submission Details

| Field | Details |
|-------|---------|
| **Challenge** | Mobile SecOps 21 Days Challenge |
| **Organizer** | Metairflow R&D Sdn. Bhd. |
| **Team** | VECNA |
| **Institution** | UiTM Tapah |
| **Project Duration** | 27 November 2025 - 17 December 2025 |

---

## ğŸ‘¥ Team Vecna Members

<div align="center">
  <table>
    <tr>
      <td align="center" width="500">
        <img src="github/assets/bukh.jpg" width="350" height="350" alt="Bukhari"><br>
        <b>MOHAMAD BUKHARI BIN<br>AHMAD HUZAIRI</b><br>
        <code>2024916761</code><br>
        <sub>Backend & Cloud Infrastructure</sub>
      </td>
      <td align="center" width="500">
        <img src="github/assets/zul.jpg" width="350" height="350" alt="Zulkarnain"><br>
        <b>MUHAMAD ZULKARNAIN BIN<br>SAMSUDIN</b><br>
        <code>2024793133</code><br>
        <sub>Frontend & Beta Tester</sub>
      </td>
      <td align="center" width="500">
        <img src="github/assets/aqil.jpg" width="350" height="350" alt="Aqil"><br>
        <b>AQIL IMRAN BIN<br>NORHIDZAM</b><br>
        <code>2024779269</code><br>
        <sub>Security Lead</sub>
      </td>
    </tr>
  </table>
</div>

---

## ğŸ”— Quick Links & Demo Credentials

| Platform | Link |
|----------|------|
| ğŸŒ **Live Website** | [https://rentverse-frontend-nine.vercel.app/](https://rentverse-frontend-nine.vercel.app/) |
| ğŸ“± **Mobile App (APK)** | [Download RentVerse APK](MobileAppBuild/rentverse-vecna.apk) |
| ğŸ“š **API Docs** | [Swagger Documentation](/docs) |

### ğŸ§ª Demo Credentials

| Role | Email | Password | MFA |
|------|-------|----------|-----|
| **Admin** | `admin@rentverse.com` | `password123` | Disabled for testing |

> âš ï¸ **Note**: For regular USER/LANDLORD accounts, you must register with a **real email address** for OTP verification.

---

## ğŸ“‘ Table of Contents

| Section | Description |
|---------|-------------|
| [ğŸ›¡ï¸ Security Compliance](#ï¸-security-compliance-matrix) | OWASP alignment & security status |
| [ğŸ—ï¸ System Architecture](#ï¸-system-architecture) | Technology stack & project structure |
| [ğŸ“ˆ System Flow Diagrams](#-system-flow-diagrams) | Architecture & flow visualizations |
| [ğŸ”§ Development Platforms](#-development-platforms) | Hosting & services used |
| **ğŸ›¡ï¸ Core Security Modules (1-6)** | |
| [Module 1: Secure Login & MFA](#-module-1-secure-login--mfa-) | Authentication & Authorization |
| [Module 2: Secure API Gateway](#-module-2-secure-api-gateway-) | HTTPS, JWT, Rate Limiting |
| [Module 3: Digital Agreement](#-module-3-digital-agreement-) | PDF Generation & Signatures |
| [Module 4: Smart Notification](#-module-4-smart-notification--alert-system-) | Anomaly Detection & Alerts |
| [Module 5: Activity Log Dashboard](#-module-5-activity-log-dashboard-) | Security Monitoring |
| [Module 6: CI/CD Security Testing](#-module-6-cicd-security-testing-) | DevSecOps Pipeline |
| **ğŸš€ Feature Innovation Pool** | |
| [Category 1: Threat Intelligence](#-category-1-threat-intelligence-system-ï¸) | Risk scoring & pattern detection |
| [Category 2: Zero-Trust Access](#-category-2-zero-trust-access-logic-) | Device verification & session control |
| [Category 3: Adaptive Defense](#-category-3-adaptive-defense-dashboard-) | Security monitoring dashboard |
| [Category 4: Automated Testing](#-category-4-automated-security-testing-) | CI/CD security scanning |
| **â­ Special Features (12)** | |
| [Smart MFA](#-1-smart-multi-factor-authentication-mfa) | Role-based authentication |
| [Digital Agreements](#-2-digital-rental-agreements) | E-signatures & PDF generation |
| [AI Security Monitoring](#-3-ai-powered-security-monitoring) | Anomaly detection |
| [Multi-Tier Rate Limiting](#-4-multi-tier-api-rate-limiting) | API protection |
| [Interactive Maps](#-5-interactive-map-integration) | MapTiler integration |
| [High-Speed OTP](#-6-high-speed-otp-delivery-system) | Fast OTP delivery |
| [Activity Logging](#-7-comprehensive-activity-logging) | Audit trails |
| [Anomaly Detection](#-8-security-anomaly-detection) | Threat monitoring |
| [PDF Generation](#-9-pdf-generation-with-digital-signatures) | Document management |
| [CI/CD Pipeline](#-10-cicd-security-pipeline) | Automated security |
| [Mobile App](#-11-mobile-first-progressive-design) | Capacitor Android |
| [Cloud Media](#-12-cloud-based-media-management) | Cloudinary CDN |
| **ğŸ“– User Guide** | |
| [Getting Started](#-getting-started) | Access points & demo |
| [User Registration](#-user-registration) | Sign up process |
| [Login Process](#-login-process-mfaotp) | MFA/OTP flow |
| [Browsing Properties](#-browsing-properties) | Property search |
| [Making a Booking](#-making-a-booking) | Booking workflow |
| [Property Management](#-property-management-landlord) | Landlord features |
| [Admin Dashboard](#-admin-dashboard-features) | Admin capabilities |
| **ğŸ”Œ API Documentation** | |
| [Authentication Endpoints](#-authentication-endpoints) | Login, register, OTP |
| [Property Endpoints](#-property-endpoints) | CRUD operations |
| [Booking Endpoints](#-booking-endpoints) | Reservation management |
| [Admin Endpoints](#-admin-endpoints) | Administration |
| **ğŸš€ Deployment Guide** | |
| [Local Setup](#-local-development-setup) | Development environment |
| [Backend Deployment](#ï¸-backend-deployment) | Railway/Render |
| [Frontend Deployment](#-frontend-deployment-vercel) | Vercel |
| [Mobile Build](#-mobile-app-build-android) | Android APK |
| [Troubleshooting](#-troubleshooting) | Common issues |

---

## ğŸ›¡ï¸ Security Compliance Matrix

| Requirement ID | Security Module | Implementation Status | OWASP Alignment |
| :--- | :--- | :---: | :--- |
| **SEC-01** | **Multi-Factor Authentication** | âœ… Implemented | M2: Insecure Authentication |
| **SEC-02** | **API Rate Limiting** | âœ… Implemented | M4: Insufficient Input/Output Validation |
| **SEC-03** | **Data Encryption (At Rest)** | âœ… Implemented | M5: Insecure Data Storage |
| **SEC-04** | **Data Encryption (In Transit)** | âœ… Implemented | M3: Insecure Communication |
| **SEC-05** | **Input Sanitization** | âœ… Implemented | M7: Client Code Quality |
| **SEC-06** | **Audit Logging** | âœ… Implemented | M1: Improper Platform Usage |

### OWASP Mobile Top 10 Coverage

| OWASP Mobile Top 10 | Implementation |
|---------------------|----------------|
| M1: Improper Platform Usage | Role-based access, activity logging |
| M2: Insecure Data Storage | Encrypted passwords, secure sessions |
| M3: Insecure Communication | HTTPS enforcement, secure headers |
| M4: Insecure Authentication | MFA, OTP, JWT with blacklist |
| M5: Insufficient Cryptography | SHA-256 hashing, JWT signatures |
| M6: Insecure Authorization | RBAC, permission validation |
| M7: Client Code Quality | ESLint, TypeScript, input validation |

---

## ğŸ—ï¸ System Architecture

### Technology Stack Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENT LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“± Mobile App (Capacitor)    â”‚    ğŸŒ Web App (Next.js 16)      â”‚
â”‚  - Android APK                â”‚    - React 19.1 + TypeScript    â”‚
â”‚  - Deep Linking Support       â”‚    - Tailwind CSS + Zustand     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     API GATEWAY LAYER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” JWT Authentication        â”‚    â±ï¸ Multi-Tier Rate Limiting  â”‚
â”‚  ğŸ›¡ï¸ Helmet.js Security       â”‚    ğŸŒ CORS Configuration        â”‚
â”‚  ğŸš« XSS/SQL Injection         â”‚    ğŸ“Š Request Validation        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BACKEND SERVICES                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Express.js API Server        â”‚    Prisma ORM (PostgreSQL)      â”‚
â”‚  - rentverse-backend/src/     â”‚    - prisma/schema.prisma       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     EXTERNAL SERVICES                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â˜ï¸ Supabase (PostgreSQL)    â”‚    ğŸ“§ Resend (Email API)        â”‚
â”‚  ğŸ–¼ï¸ Cloudinary (Media CDN)   â”‚    ğŸ—ºï¸ MapTiler (Maps)           â”‚
â”‚  ğŸ”‘ Google OAuth              â”‚    ğŸ¤– AI Service (FastAPI)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ Project Structure

```
uitm-devops-challenge_VECNA-main/
â”‚
â”œâ”€â”€ rentverse-backend/              # Express.js Backend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app.js                  # Main Express application
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ database.js         # Prisma database connection
â”‚   â”‚   â”‚   â””â”€â”€ storage.js          # Cloudinary configuration
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js             # JWT authentication
â”‚   â”‚   â”‚   â”œâ”€â”€ rateLimiter.js      # Multi-tier rate limiting
â”‚   â”‚   â”‚   â””â”€â”€ security.js         # CSP, XSS, SQL injection protection
â”‚   â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”‚   â”œâ”€â”€ users/              # User management
â”‚   â”‚   â”‚   â”œâ”€â”€ properties/         # Property CRUD
â”‚   â”‚   â”‚   â”œâ”€â”€ bookings/           # Booking & leases
â”‚   â”‚   â”‚   â””â”€â”€ admin/              # Admin dashboard
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ enhancedMFA.service.js      # Role-based MFA
â”‚   â”‚   â”‚   â”œâ”€â”€ fastOTPService.js           # High-speed OTP delivery
â”‚   â”‚   â”‚   â”œâ”€â”€ securityAnomalyDetection.js # AI anomaly detection
â”‚   â”‚   â”‚   â”œâ”€â”€ digitalSignatureValidation.js # JWT document signing
â”‚   â”‚   â”‚   â”œâ”€â”€ pdfGeneration.service.js    # Puppeteer PDF creation
â”‚   â”‚   â”‚   â””â”€â”€ enhancedEmailService.js     # Email templates
â”‚   â”‚   â””â”€â”€ routes/                 # API route definitions
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â””â”€â”€ schema.prisma           # Database schema
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ rental-agreement.ejs    # PDF template
â”‚
â”œâ”€â”€ rentverse-frontend/             # Next.js Frontend
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ page.tsx                # Homepage
â”‚   â”‚   â”œâ”€â”€ auth/                   # Login, register, forgot password
â”‚   â”‚   â”œâ”€â”€ property/               # Property listing & details
â”‚   â”‚   â”œâ”€â”€ rents/                  # User bookings
â”‚   â”‚   â”œâ”€â”€ admin/                  # Admin dashboard
â”‚   â”‚   â””â”€â”€ account/                # User profile & security settings
â”‚   â”œâ”€â”€ components/                 # Reusable UI components
â”‚   â”œâ”€â”€ stores/                     # Zustand state management
â”‚   â”œâ”€â”€ utils/                      # Utility functions
â”‚   â””â”€â”€ android/                    # Capacitor Android build
â”‚
â”œâ”€â”€ rentverse-ai-service/           # Python AI Service
â”‚   â”œâ”€â”€ rentverse/                  # FastAPI application
â”‚   â””â”€â”€ models/                     # ML models
â”‚
â”œâ”€â”€ rentverse-mobile-app/           # Mobile App Configuration
â”‚
â””â”€â”€ .github/
    â””â”€â”€ workflows/
        â””â”€â”€ security-scan.yml       # CI/CD security pipeline
```

---

## ğŸ“ˆ System Flow Diagrams

### ğŸ” Authentication Flow (MFA/OTP)

```mermaid
sequenceDiagram
    participant U as ğŸ‘¤ User
    participant F as ğŸŒ Frontend
    participant A as ğŸ” Auth API
    participant D as ğŸ—„ï¸ Database
    participant E as ğŸ“§ Email Service

    U->>F: Enter email & password
    F->>A: POST /auth/login
    A->>D: Verify credentials
    
    alt Invalid Credentials
        A-->>F: 401 Unauthorized
        A->>D: Log failed attempt
        D-->>A: Check attempt count
        alt 5+ Failed Attempts
            A->>E: Send notification to admin
        end
    else Valid Credentials
        A->>D: Check MFA status
        alt MFA Enabled
            A->>A: Generate 6-digit OTP
            A->>D: Store hashed OTP
            A->>E: Send OTP email
            A-->>F: Require OTP verification
            U->>F: Enter OTP code
            F->>A: POST /auth/verify-otp
            A->>D: Verify OTP hash
            alt Valid OTP
                A->>D: Log successful login
                A->>D: Register device
                A-->>F: Return JWT token
            else Invalid OTP
                A-->>F: 401 Invalid OTP
            end
        else MFA Disabled
            A->>D: Log successful login
            A-->>F: Return JWT token
        end
    end
```

### ğŸ  Property Booking Flow

```mermaid
flowchart TD
    A[Tenant Selects Property] --> B[Choose Dates]
    B --> C[POST /api/bookings]
    C --> D{Availability Check}
    D -->|Available| E[Create Booking Record]
    D -->|Unavailable| F[Return Error]
    E --> G[Create Lease Record]
    G --> H[Generate PDF Agreement]
    H --> I[Create SHA-256 Hash]
    I --> J[Upload to Cloudinary]
    J --> K[Save to Database]
    K --> L[Notify Both Parties]
    L --> M[Booking Complete]
```

### ğŸ›¡ï¸ Security Monitoring Flow

```mermaid
flowchart LR
    subgraph Events["ğŸ“¥ Security Events"]
        E1["Login Attempt"]
        E2["Failed Login"]
        E3["New Device"]
        E4["Password Change"]
    end

    subgraph Analysis["ğŸ” Risk Analysis"]
        A1["Calculate Risk Score"]
        A2{"Risk >= 50?"}
        A3["Log Normal Activity"]
        A4["Flag High Risk"]
    end

    subgraph Response["âš¡ Auto Response"]
        R1["Create Security Alert"]
        R2["Send Email Notification"]
        R3["Lock Account<br/>if 5+ failures"]
    end

    E1 --> A1
    E2 --> A1
    E3 --> A1
    E4 --> R1
    A1 --> A2
    A2 -->|No| A3
    A2 -->|Yes| A4
    A4 --> R1
    R1 --> R2
    E2 --> R3
```

### ğŸ”„ CI/CD Security Pipeline

```mermaid
flowchart LR
    subgraph Trigger["ğŸš€ Trigger"]
        T1["Push to Main"]
        T2["Pull Request"]
    end

    subgraph SAST["ğŸ”¬ SAST Checks"]
        S1["ESLint Analysis"]
        S2["TypeScript Check"]
        S3["npm Audit"]
    end

    subgraph Security["ğŸ” Security Scans"]
        SEC1["CodeQL Analysis"]
        SEC2["Gitleaks<br/>Secret Detection"]
        SEC3["Trivy<br/>Vulnerability Scan"]
    end

    subgraph Build["ğŸ—ï¸ Build"]
        B1["Backend Build"]
        B2["Frontend Build"]
    end

    subgraph Deploy["ğŸ“¦ Deploy"]
        D1["Vercel<br/>Frontend"]
        D2["Render<br/>Backend"]
    end

    T1 --> SAST
    T2 --> SAST
    SAST --> Security
    Security --> Build
    Build --> Deploy
```

---

## ğŸ”§ Development Platforms

<div align="center">
  <table>
    <tr>
      <td align="center" width="120">
        <img src="https://assets.vercel.com/image/upload/v1588805858/repositories/vercel/logo.png" width="48" height="48"><br>
        <b>Vercel</b><br>
        <sub>Frontend Hosting</sub>
      </td>
      <td align="center" width="120">
        <img src="https://images.g2crowd.com/uploads/product/image/large_detail/large_detail_477db83f729d63210139ec7cd29c1351/render-render.png" width="48" height="48"><br>
        <b>Render</b><br>
        <sub>Backend Hosting</sub>
      </td>
      <td align="center" width="120">
        <img src="https://www.vectorlogo.zone/logos/supabase/supabase-icon.svg" width="48" height="48"><br>
        <b>Supabase</b><br>
        <sub>PostgreSQL Database</sub>
      </td>
      <td align="center" width="120">
        <img src="https://cdn.simpleicons.org/resend" width="48" height="48"><br>
        <b>Resend</b><br>
        <sub>Email Service</sub>
      </td>
    </tr>
    <tr>
      <td align="center" width="120">
        <img src="https://user-images.githubusercontent.com/236501/85893648-1c92e880-b7a8-11ea-926d-95355b8175c7.png" width="48" height="48"><br>
        <b>Capacitor</b><br>
        <sub>Mobile App</sub>
      </td>
      <td align="center" width="120">
        <img src="https://www.vectorlogo.zone/logos/google/google-icon.svg" width="48" height="48"><br>
        <b>Google OAuth</b><br>
        <sub>Authentication</sub>
      </td>
      <td align="center" width="120">
        <img src="https://avatars.githubusercontent.com/u/1460763" width="48" height="48"><br>
        <b>Cloudinary</b><br>
        <sub>Media Storage</sub>
      </td>
      <td align="center" width="120">
        <img src="https://cdn.simpleicons.org/maptiler" width="48" height="48"><br>
        <b>MapTiler</b><br>
        <sub>Maps & Geocoding</sub>
      </td>
    </tr>
    <tr>
      <td align="center" width="120">
        <img src="https://www.vectorlogo.zone/logos/github/github-icon.svg" width="48" height="48"><br>
        <b>GitHub Actions</b><br>
        <sub>CI/CD Pipeline</sub>
      </td>
      <td align="center" width="120">
        <img src="https://avatars.githubusercontent.com/u/17219288" width="48" height="48"><br>
        <b>Prisma</b><br>
        <sub>ORM</sub>
      </td>
      <td align="center" width="120">
        <img src="https://www.vectorlogo.zone/logos/nodejs/nodejs-icon.svg" width="48" height="48"><br>
        <b>Node.js</b><br>
        <sub>Runtime</sub>
      </td>
      <td align="center" width="120">
        <img src="https://www.vectorlogo.zone/logos/nextjs/nextjs-icon.svg" width="48" height="48"><br>
        <b>Next.js</b><br>
        <sub>React Framework</sub>
      </td>
    </tr>
  </table>
</div>

---

## ğŸ›¡ï¸ Core Security Modules (Module 1-6)

### ğŸŸ¢ Module 1: Secure Login & MFA ğŸ”

**Description:** Role-based MFA/OTP login with device verification and suspicious activity detection.  
**Security Focus:** Authentication & Authorization (OWASP M1â€“M3)  
**Key Files:** `src/services/enhancedMFA.service.js`, `src/services/fastOTPService.js`

#### Role-Based MFA Policies

| Role | MFA Required | Session Timeout | Max Failed Attempts | Login Hours | Device Verification |
|------|--------------|-----------------|---------------------|-------------|---------------------|
| **ADMIN** | âœ… Yes | 15 min | 3 attempts | 6 AM - 10 PM | âœ… Required |
| **LANDLORD** | âœ… Yes | 30 min | 5 attempts | 5 AM - 11 PM | âœ… Required |
| **USER** | âŒ Optional | 60 min | 5 attempts | 24/7 | âŒ Optional |

```javascript
// Role-Based MFA Policy Configuration (enhancedMFA.service.js)
roleBasedMFAPolicies = {
  ADMIN: {
    requireMFA: true,
    allowedMethods: ['TOTP', 'SMS', 'EMAIL'],
    sessionTimeout: 15, // minutes
    maxFailedAttempts: 3,
    allowedLoginHours: { start: 6, end: 22 },
    requireDeviceVerification: true
  },
  LANDLORD: {
    requireMFA: true,
    allowedMethods: ['TOTP', 'EMAIL'],
    sessionTimeout: 30,
    maxFailedAttempts: 5,
    requireDeviceVerification: true
  },
  USER: {
    requireMFA: false,
    sessionTimeout: 60,
    requireDeviceVerification: false
  }
};
```

#### Multi-Factor Authentication Features

| Feature | Implementation |
|---------|----------------|
| **OTP Generation** | Speakeasy TOTP with 5-minute step window |
| **OTP Delivery** | Parallel email + SMS delivery via `fastOTPService.js` |
| **TOTP Authenticator** | QR code generation for Google Authenticator |
| **Backup Codes** | 10 recovery codes generated on MFA setup |
| **Expiry** | Role-based (15-60 minutes based on user role) |

#### Suspicious Activity Detection

| Risk Factor | Points Added | Description |
|-------------|--------------|-------------|
| Previous Failed Attempts | +0.3 | User has failed login attempts |
| Rapid Logins | +0.2 | Login within 1 hour of last attempt |
| Outside Normal Hours | +0.4 | Login outside configured hours |
| **Block Threshold** | **> 0.8** | User login blocked |

---

### ğŸ”µ Module 2: Secure API Gateway ğŸ”’

**Description:** Multi-tier rate limiting, security headers, and request validation.  
**Security Focus:** Secure Communication (OWASP M5â€“M6)  
**Key Files:** `src/middleware/rateLimiter.js`, `src/middleware/security.js`

#### Multi-Tier Rate Limiting

| Limiter Type | Limit | Window | Purpose |
|--------------|-------|--------|---------|
| **General** | 100 requests | 15 min | Standard API protection |
| **Login** | 5 attempts | 15 min | Brute force prevention |
| **Register** | 3 attempts | 1 hour | Registration abuse |
| **OTP** | 3 requests | 10 min | OTP flooding prevention |
| **Admin** | 50 requests | 15 min | Admin endpoint protection |
| **Upload** | 10 uploads | 1 hour | File upload control |
| **Search** | 200 requests | 15 min | Search abuse prevention |
| **Password Reset** | 3 requests | 1 hour | Reset abuse prevention |

#### Security Middleware Stack

| Middleware | Purpose |
|------------|---------|
| **Helmet.js** | Security headers (XSS, CSP, HSTS, frame protection) |
| **HTTPS Enforcement** | Redirect HTTP to HTTPS for secure paths |
| **XSS Protection** | Null byte removal from request bodies |
| **SQL Injection Detection** | Pattern-based detection with logging |
| **CORS Config** | Allowlist-based origin validation |
| **Request Size Limit** | 10MB maximum request size |

---

### ğŸŸ£ Module 3: Digital Agreement ğŸ“

**Description:** JWT-based digital signatures with replay attack prevention and document integrity verification.  
**Security Focus:** Data Integrity & Workflow Validation  
**Key Files:** `src/services/digitalSignatureValidation.js`, `src/services/pdfGeneration.service.js`

#### Digital Signature Features

| Feature | Implementation |
|---------|----------------|
| **JWT Signatures** | Cryptographic signing with 24-hour expiry |
| **Nonce Generation** | 16-byte random nonce prevents replay attacks |
| **Document Hash** | SHA-256 with secret salt for integrity |
| **Permission Check** | Validates user access (owner, tenant, or signer) |

#### PDF Generation Process

1. **Data Collection**: Fetch lease, property, tenant, landlord data
2. **Template Rendering**: EJS template with dynamic data
3. **QR Code Generation**: Create QR codes for both parties
4. **PDF Creation**: Puppeteer renders HTML to PDF (A4 format)
5. **Hash Generation**: SHA-256 hash of PDF buffer
6. **Cloud Upload**: Upload to Cloudinary CDN
7. **Database Storage**: Save URL, hash, and metadata

---

### ğŸŸ  Module 4: Smart Notification & Alert System ğŸ””

**Description:** AI-powered security anomaly detection with automated alert system.  
**Security Focus:** DevSecOps Monitoring & Incident Detection  
**Key Files:** `src/services/securityAnomalyDetection.js`, `src/services/enhancedEmailService.js`

#### Security Anomaly Detection

| Anomaly Type | Severity | Trigger | Auto-Alert |
|--------------|----------|---------|------------|
| `FAILED_LOGIN` | HIGH | 5+ failed OTP attempts in 15 min | âœ… Yes |
| `MULTIPLE_FAILED_LOGINS` | HIGH | 3+ failed logins in 15 min | âœ… Yes |
| `UNUSUAL_ACCESS_TIME` | MEDIUM | Login outside 11 PM - 6 AM | âŒ Log only |
| `MULTIPLE_SESSIONS` | MEDIUM | Multiple logins within 5 min | âŒ Log only |
| `API_ABUSE` | HIGH | Rate limit breaches | âœ… Yes |
| `BRUTE_FORCE` | CRITICAL | Sustained attack pattern | âœ… Yes |

#### AI Service Integration

The system integrates with a FastAPI-based AI service at `/api/v1/anomaly/detect` that analyzes:
- User ID and email
- IP address and user agent
- Login success/failure status
- Recent activity (last 24 hours)

---

### ğŸ”´ Module 5: Activity Log Dashboard ğŸ“Š

**Description:** Provide admin-level logs for failed logins and critical actions.  
**Security Focus:** Threat Visualization & Accountability

#### Dashboard Statistics

| Metric | Description |
|--------|-------------|
| 24h Login Metrics | Total, successful, failed logins |
| OAuth vs Email | Breakdown of login methods |
| High Risk Logins | Logins with risk score â‰¥50 |
| Locked Accounts | Currently locked user accounts |
| 7-Day Trends | Daily login success/failure charts |

#### Logged Events

| Event Category | Actions Logged |
|----------------|----------------|
| **Authentication** | LOGIN_SUCCESS, LOGIN_FAILED, LOGOUT |
| **OTP** | OTP_GENERATED, OTP_VERIFIED, OTP_FAILED_INVALID |
| **MFA** | MFA_ENABLED, MFA_DISABLED, TOTP_SETUP |
| **Account** | PASSWORD_CHANGED, PROFILE_UPDATED |
| **Security** | ACCOUNT_LOCKED, SUSPICIOUS_ACTIVITY |
| **Admin** | USER_MODIFIED, ANOMALY_RESOLVED |

---

### ğŸ”· Module 6: CI/CD Security Testing âš™ï¸

**Description:** Automated security scanning pipeline with multi-tool analysis.  
**Security Focus:** Continuous Testing (DevSecOps)  
**Workflow File:** `.github/workflows/security-scan.yml`

#### Security Tools Matrix

| Tool | Purpose | Language | Report |
|------|---------|----------|--------|
| **Bandit** | Python SAST security linter | Python | JSON/TXT |
| **Semgrep** | Multi-language SAST scanner | JS/TS | SARIF |
| **CodeQL** | Semantic code analysis | JS/Python | SARIF |
| **npm audit** | Node.js dependency vulnerabilities | Node.js | Console |
| **Safety** | Python package vulnerabilities | Python | JSON |
| **TruffleHog** | Secret/credential detection | All | Console |

**Triggers:** Push to `main`/`develop`, Pull requests to `main`

---

## ğŸš€ Feature Innovation Pool (Category 1-4)

### ğŸŸ¡ Category 1: Threat Intelligence System ğŸ›¡ï¸

**Description:** Rule-based module that detects unusual access patterns, repeated failed logins, and potential intrusion attempts.

#### Risk Score Calculation

| Pattern Type | Detection Criteria | Points | Severity |
|--------------|-------------------|--------|----------|
| New Device | Unrecognized device hash | +30 | Medium |
| Multiple Failures | 3+ failures in 5 minutes | +25 | High |
| Geographic Anomaly | Logins from 3+ IPs in 1 hour | +20 | Medium |
| Unusual Timing | Logins between 2-5 AM | +15 | Low |
| Brute Force | 5 failed attempts â†’ account lock | +50 | Critical |

---

### ğŸŸª Category 2: Zero-Trust Access Logic ğŸ”

**Description:** Conditional access controls including device verification, automatic token invalidation, and comprehensive session management.

#### Zero-Trust Features

| Feature | Implementation | OWASP Alignment |
|---------|---------------|-----------------|
| New Device Alerts | Email + Security Alert | M1, M3 |
| Token Blacklisting | In-memory with cleanup | M6 |
| Session Validation | JWT expiry + blacklist check | M1 |
| User-Agent Tracking | SHA-256 fingerprinting | M3 |

---

### ğŸŸ© Category 3: Adaptive Defense Dashboard ğŸ’»

**Description:** Interactive admin dashboard that visualizes system risk levels and auto-responds to flagged security events.

#### Auto-Response Mechanisms

| Trigger | Automatic Response | Notification |
|---------|-------------------|--------------|
| 5 Failed Logins | Account locked 15 min | Email + Alert |
| High Risk Login | Security alert created | Email |
| New Device | Device registered + alert | Email |
| Multiple IPs | Suspicious activity flag | Dashboard |

---

### ğŸŸ« Category 4: Automated Security Testing ğŸ§ª

**Description:** Integrated security scanning tools in CI/CD pipeline that run automatically before each deployment.

#### Security Gates

- âŒ Build fails on HIGH/CRITICAL vulnerabilities
- âŒ Build fails on detected secrets
- âŒ Build fails on critical ESLint errors
- âœ… Security report generated for each run

---

## â­ Special Features (12 Features)

### ğŸ” 1. Smart Multi-Factor Authentication (MFA)

RentVerse implements intelligent **Role-Based Multi-Factor Authentication** that adapts security requirements based on user roles and detected risk levels.

**Key Features:**
- TOTP Support (Google Authenticator via Speakeasy)
- QR Code Generation for easy setup
- Backup Codes (10 recovery codes)
- Device Verification for privileged roles
- Risk-Based Blocking (score > 0.8)

---

### ğŸ“„ 2. Digital Rental Agreements

Automatically generates **legally-binding PDF rental agreements** with cryptographic digital signatures.

| Section | Information Included |
|---------|---------------------|
| **Header** | Agreement ID, Date, Logo |
| **Property Details** | Title, Address, Type, Amenities |
| **Parties** | Landlord & Tenant full details |
| **Terms** | Start/End dates, Rent amount |
| **Signatures** | QR codes for landlord & tenant |
| **Security** | SHA-256 hash, Timestamp |

---

### ğŸ¤– 3. AI-Powered Security Monitoring

Integrates with **FastAPI-based AI service** for real-time behavior analysis.

| Pattern | Detection Method | Severity |
|---------|------------------|----------|
| Multiple Failed Logins | Count within 15-minute window | HIGH |
| Unusual Access Time | Login during 11 PM - 6 AM | MEDIUM |
| New Device | Unrecognized user agent/IP | MEDIUM |
| Brute Force Attack | Sustained failed attempts | CRITICAL |

---

### â±ï¸ 4. Multi-Tier API Rate Limiting

**8 different rate limiters** tailored for specific endpoint categories.

| Limiter | Limit | Window | Purpose |
|---------|-------|--------|---------|
| General | 100 | 15 min | Standard protection |
| Login | 5 | 15 min | Brute force prevention |
| OTP | 3 | 10 min | OTP flooding prevention |
| Upload | 10 | 1 hour | Storage abuse prevention |

---

### ğŸ—ºï¸ 5. Interactive Map Integration

**MapTiler SDK** for property location selection and display.

| Feature | Description |
|---------|-------------|
| Location Picker | Landlords click on map to set coordinates |
| Geocoding | Address auto-completion |
| Property Display | Show property locations with markers |
| Distance Calculation | Calculate distance from user |

---

### âš¡ 6. High-Speed OTP Delivery System

**High-performance OTP delivery** with parallel processing.

| Feature | Description |
|---------|-------------|
| Parallel Delivery | Email + SMS sent simultaneously |
| Connection Pooling | Max 5 connections, 100 messages |
| Styled Templates | Beautiful HTML emails with branding |
| Expiry | OTPs expire after 5 minutes |

---

### ğŸ“Š 7. Comprehensive Activity Logging

Every security-relevant action logged for audit trails.

**Log Entry Structure:**
- User ID, Action type
- IP Address, User Agent
- Timestamp, Risk Score
- Severity level

---

### ğŸ›¡ï¸ 8. Security Anomaly Detection

Monitors user behavior and flags suspicious patterns.

| Type | Threshold | Severity |
|------|-----------|----------|
| Failed Login | 3+ in 15 min | HIGH |
| Unusual Time | 11 PM - 6 AM | MEDIUM |
| Multiple Sessions | 2+ in 5 min | MEDIUM |
| Rate Limit Exceeded | 5+ breaches | HIGH |

---

### ğŸ“ 9. PDF Generation with Digital Signatures

**Puppeteer** generates professional PDF agreements with embedded signatures.

**PDF Contents:**
- Agreement Header (ID, Date, Logo)
- Property Info (Title, address, amenities)
- Landlord & Tenant Details
- Terms and Legal Text
- Security Footer (SHA-256 hash)

---

### âš™ï¸ 10. CI/CD Security Pipeline

Automated security scanning using **6 different tools**.

| Tool | Purpose |
|------|---------|
| Bandit | Python SAST |
| Semgrep | Multi-language SAST |
| CodeQL | Semantic analysis |
| npm audit | Dependency vulnerabilities |
| Safety | Python vulnerabilities |
| TruffleHog | Secret detection |

---

### ğŸ“± 11. Mobile-First Progressive Design

**Capacitor** generates native Android applications.

| Feature | Description |
|---------|-------------|
| Native APK | Standalone Android app |
| Deep Linking | `rentverseclarity://` URL scheme |
| Push Notifications | Real-time updates |
| Offline Support | Cached assets |

---

### â˜ï¸ 12. Cloud-Based Media Management

**Cloudinary CDN** for all media storage.

| Feature | Description |
|---------|-------------|
| Auto Optimization | Images auto-compressed |
| CDN Delivery | Global edge network |
| Secure Upload | Signed upload requests |
| PDF Storage | Rental agreements stored securely |

---

## ğŸ“– User Guide

### ğŸš€ Getting Started

| Platform | URL/Download |
|----------|--------------|
| ğŸŒ Web Application | [rentverse-frontend-nine.vercel.app](https://rentverse-frontend-nine.vercel.app/) |
| ğŸ“± Android App | [Download APK](MobileAppBuild/rentverse-vecna.apk) |
| ğŸ“š API Documentation | [Swagger UI](https://rentverse-backend.up.railway.app/docs) |

---

### ğŸ‘¤ User Registration

#### Step 1: Navigate to Sign Up
1. Open RentVerse (web or mobile)
2. Click **"Sign Up"**

#### Step 2: Fill Registration Form

| Field | Requirement |
|-------|-------------|
| Email | Valid email address (used for OTP) |
| Password | Minimum 6 characters |
| First Name | Your first name |
| Last Name | Your last name |

#### Step 3: Verify Email with OTP
1. Check your email inbox
2. Enter the **6-digit OTP code** within **5 minutes**
3. Click **"Verify"**

#### User Roles

| Role | Description | How to Get |
|------|-------------|------------|
| **USER** | Regular tenant | Default on registration |
| **LANDLORD** | Property owner | Select during registration |
| **ADMIN** | Platform administrator | Assigned by system |

---

### ğŸ” Login Process (MFA/OTP)

#### Step 1: Enter Credentials
1. Enter registered **email** and **password**
2. Click **"Login"**

#### Step 2: OTP Verification
1. Check your email for the OTP
2. Enter the **6-digit OTP code**
3. Click **"Verify OTP"**

#### Step 3: Access Granted
- Session duration depends on role:
  - ADMIN: 15 minutes
  - LANDLORD: 30 minutes
  - USER: 60 minutes

---

### ğŸ  Browsing Properties

**Homepage Features:**
- Property Cards - Show image, title, price, location
- Search Bar - Filter by location or keywords
- Filters - Property Type, Price Range, Bedrooms, Bathrooms

**Property Details:**
- Gallery, Description, Amenities
- Interactive map with location
- Pricing and terms
- Owner info and availability

**Actions:**
- â¤ï¸ Add to Wishlist
- ğŸ“… Book Now
- ğŸ“§ Contact Owner

---

### ğŸ“… Making a Booking

1. **Select Property** - Browse and click "Book Now"
2. **Choose Dates** - Select check-in and check-out dates
3. **Enter Details** - Number of guests, special requests
4. **Confirm Booking** - Review and confirm
5. **Agreement Generated** - PDF rental agreement created automatically

---

### ğŸ¢ Property Management (Landlord)

#### Adding a New Property

1. **Basic Info** - Title, Description, Property Type
2. **Location** - Use interactive map to select coordinates
3. **Photos & Amenities** - Upload images, select amenities
4. **Pricing** - Set monthly rent and terms
5. **Publish** - Make listing live

#### Managing Properties

| Action | Description |
|--------|-------------|
| Edit | Modify details, pricing, photos |
| Delete | Remove listing permanently |
| View Bookings | See all booking requests |
| Toggle Availability | Mark available/unavailable |

---

### ğŸ‘‘ Admin Dashboard Features

| Module | Capabilities |
|--------|--------------|
| ğŸ‘¥ User Management | View, suspend, delete users |
| ğŸ  Property Moderation | Approve, reject, feature listings |
| ğŸ“ Agreement Oversight | View all agreements, download PDFs |
| ğŸ”’ Security Logs | View login attempts, security events |
| ğŸ“Š Statistics | Login metrics, trends, at-risk users |

---

## ğŸ”Œ API Documentation

### Base URLs

| Environment | URL |
|-------------|-----|
| **Production** | `https://rentverse-backend-production.up.railway.app` |
| **Development** | `http://localhost:3000` |
| **API Docs** | `{BASE_URL}/docs` (Swagger UI) |

### Authentication Header

```
Authorization: Bearer <your-jwt-token>
```

---

### ğŸ” Authentication Endpoints

| Endpoint | Method | Description | Auth | Rate Limit |
|----------|--------|-------------|------|------------|
| `/api/auth/register` | POST | User registration | âŒ | 3/hour |
| `/api/auth/login` | POST | Login (returns OTP pending) | âŒ | 5/15min |
| `/api/auth/verify-otp` | POST | OTP verification â†’ JWT | âŒ | 3/10min |
| `/api/auth/forgot-password` | POST | Send password reset OTP | âŒ | 3/hour |
| `/api/auth/reset-password` | POST | Reset password with OTP | âŒ | 3/hour |
| `/api/auth/logout` | POST | Invalidate JWT token | âœ… | - |

---

### ğŸ  Property Endpoints

| Endpoint | Method | Description | Auth |
|----------|--------|-------------|------|
| `/api/properties` | GET | List all properties | âŒ |
| `/api/properties/:id` | GET | Property details | âŒ |
| `/api/properties` | POST | Create listing | âœ… Landlord |
| `/api/properties/:id` | PUT | Update property | âœ… Owner |
| `/api/properties/:id` | DELETE | Delete property | âœ… Owner |

**Query Parameters for GET /api/properties:**

| Parameter | Type | Description |
|-----------|------|-------------|
| `search` | string | Search by title or location |
| `type` | string | Property type ID |
| `minPrice` | number | Minimum price |
| `maxPrice` | number | Maximum price |
| `bedrooms` | number | Number of bedrooms |
| `page` | number | Page number (default: 1) |
| `limit` | number | Items per page (default: 10) |

---

### ğŸ“… Booking Endpoints

| Endpoint | Method | Description | Auth |
|----------|--------|-------------|------|
| `/api/bookings` | POST | Create booking | âœ… |
| `/api/bookings/my-bookings` | GET | User's bookings | âœ… |
| `/api/bookings/owner-bookings` | GET | Landlord's bookings | âœ… Landlord |
| `/api/bookings/:id/rental-agreement/download` | GET | Download PDF | âœ… |

---

### ğŸ‘‘ Admin Endpoints

| Endpoint | Method | Description | Auth |
|----------|--------|-------------|------|
| `/api/admin/users` | GET | List all users | âœ… Admin |
| `/api/admin/security/anomalies` | GET | Unresolved anomalies | âœ… Admin |
| `/api/admin/security/anomalies/:id/resolve` | PATCH | Resolve anomaly | âœ… Admin |
| `/api/auth/activity-logs` | GET | User activity history | âœ… Admin |
| `/api/bookings` | GET | All bookings | âœ… Admin |

---

### âŒ Error Responses

| Code | Description |
|------|-------------|
| 200 | Success |
| 201 | Created |
| 400 | Bad Request (validation error) |
| 401 | Unauthorized (missing/invalid token) |
| 403 | Forbidden (insufficient permissions) |
| 404 | Not Found |
| 423 | Locked (account locked) |
| 429 | Too Many Requests (rate limited) |
| 500 | Internal Server Error |

---

## ğŸš€ Deployment Guide

### ğŸ“¦ Prerequisites

| Tool | Version | Purpose |
|------|---------|---------|
| Node.js | 18+ | Backend & Frontend runtime |
| npm | 9+ | Package manager |
| Git | Latest | Source control |
| PostgreSQL | 15+ | Database |
| Python | 3.9+ | AI service (optional) |

---

### ğŸ’» Local Development Setup

#### 1. Clone Repository
```bash
git clone <repository-url>
cd uitm-devops-challenge_VECNA-main
```

#### 2. Backend Setup
```bash
cd rentverse-backend
npm install
cp .env.example .env    # Configure environment variables
npx prisma generate
npx prisma migrate dev
npm run dev             # Start on http://localhost:3000
```

#### 3. Frontend Setup
```bash
cd rentverse-frontend
npm install
npm run dev             # Start on http://localhost:3001
```

#### 4. AI Service (Optional)
```bash
cd rentverse-ai-service
pip install -r requirements.txt
python -m uvicorn rentverse.main:app --reload --port 8000
```

---

### âš™ï¸ Environment Variables

#### Backend (.env)
```env
# Database
DATABASE_URL=postgresql://user:password@localhost:5432/rentverse

# Authentication
JWT_SECRET=your-super-secret-jwt-key-min-32-chars
SESSION_SECRET=your-session-secret-key

# Email Service (Gmail)
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-gmail-app-password

# Cloudinary
CLOUD_CLOUD_NAME=your-cloud-name
CLOUD_API_KEY=your-api-key
CLOUD_API_SECRET=your-api-secret

# Server
PORT=3000
NODE_ENV=development
BASE_URL=http://localhost:3000
FRONTEND_URL=http://localhost:3001
```

#### Frontend (.env.local)
```env
NEXT_PUBLIC_API_URL=http://localhost:3000
NEXT_PUBLIC_MAPTILER_KEY=your-maptiler-api-key
```

---

### â˜ï¸ Backend Deployment

#### Option A: Railway
1. Go to [railway.app](https://railway.app/)
2. Create new project from GitHub
3. Set Root Directory: `rentverse-backend`
4. Add environment variables
5. Deploy (auto-deploys on push)

#### Option B: Render
1. Go to [render.com](https://render.com/)
2. Create Web Service from GitHub
3. Configure:
   - Root Directory: `rentverse-backend`
   - Build Command: `npm install && npx prisma generate`
   - Start Command: `npm start`
4. Add environment variables

---

### ğŸŒ Frontend Deployment (Vercel)

1. Go to [vercel.com](https://vercel.com/)
2. Import GitHub repository
3. Set Root Directory: `rentverse-frontend`
4. Add environment variables:
   ```
   NEXT_PUBLIC_API_URL=https://your-backend-url
   NEXT_PUBLIC_MAPTILER_KEY=your-maptiler-key
   ```
5. Deploy

---

### ğŸ“± Mobile App Build (Android)

```bash
cd rentverse-frontend

# Build production bundle
npm run build

# Sync with Capacitor
npx cap sync android

# Open in Android Studio
npx cap open android

# Build â†’ Build Bundle(s) / APK(s) â†’ Build APK(s)
```

APK location: `android/app/build/outputs/apk/debug/app-debug.apk`

---

## â“ Troubleshooting

### Common Issues

#### Backend Won't Start
```bash
# Check if port 3000 is in use
netstat -ano | findstr :3000

# Kill the process
taskkill /PID <PID> /F

# Or change port in .env
PORT=3001
```

#### Database Connection Failed
```bash
# Check PostgreSQL is running
sudo systemctl status postgresql

# Reset and re-migrate
npx prisma migrate reset
npx prisma migrate dev
```

#### OTP Not Received
1. Check spam/junk folder
2. Verify `EMAIL_USER` and `EMAIL_PASS` in `.env`
3. For Gmail, use App Password (not regular password)
4. Check backend console for email logs

#### Frontend Build Errors
```bash
# Clear cache and reinstall
rm -rf node_modules .next
npm install

# Run on different port
npm run dev -- -p 3002
```

#### Prisma Schema Errors
```bash
# Regenerate Prisma client
npx prisma generate

# Sync database
npx prisma db push

# View current database
npx prisma studio
```

### FAQ

**Q: How do I create a landlord account?**
> Set role as LANDLORD during registration, or ask admin to update your role.

**Q: Why is my login blocked?**
> Risk score exceeded 0.8. Wait 15 minutes or contact admin.

**Q: Can I disable MFA?**
> USER role can toggle MFA. ADMIN and LANDLORD have mandatory MFA.

**Q: Where are uploaded images stored?**
> All media is stored on Cloudinary CDN.

---

## ğŸ—„ï¸ Database Schema

```mermaid
erDiagram
    User ||--o{ Property : owns
    User ||--o{ Booking : makes
    User ||--o{ Lease : signs
    User ||--o{ ActivityLog : generates
    User ||--o{ SecurityAnomaly : triggers
    
    Property ||--o{ Booking : receives
    Property }|--|| PropertyType : has
    Property }o--o{ Amenity : contains
    
    Booking ||--|| Lease : creates
    Lease ||--|| RentalAgreement : generates
    
    User {
        string id PK
        string email UK
        string password
        string role
        boolean mfaEnabled
        string mfaSecret
        string otp
        datetime otpExpires
        int loginAttempts
        datetime lockedUntil
    }
    
    Property {
        string id PK
        string ownerId FK
        string title
        string description
        float price
        float latitude
        float longitude
        string propertyTypeId FK
    }
    
    Booking {
        string id PK
        string propertyId FK
        string tenantId FK
        datetime startDate
        datetime endDate
        float rentAmount
        string status
    }
    
    Lease {
        string id PK
        string bookingId FK
        string tenantId FK
        string landlordId FK
        string status
    }
    
    RentalAgreement {
        string id PK
        string leaseId FK
        string pdfUrl
        string digitalSignature
        datetime signedAt
    }
    
    ActivityLog {
        string id PK
        string userId FK
        string action
        string ipAddress
        json details
    }
    
    SecurityAnomaly {
        string id PK
        string userId FK
        string type
        string severity
        boolean resolved
    }
```

---

## ğŸ“ˆ Performance Metrics

### Response Times

| Operation | Target | Actual |
|-----------|--------|--------|
| OTP Generation | < 100ms | ~50ms |
| OTP Email Delivery | < 3s | ~1.5s |
| JWT Token Generation | < 50ms | ~20ms |
| Property Search | < 500ms | ~200ms |
| PDF Generation | < 10s | ~5-8s |

### Security Metrics

| Metric | Value |
|--------|-------|
| OTP Expiry | 5 minutes |
| JWT Expiry | Role-based (15-60 min) |
| Session Lock After | 3-5 failed attempts |
| Account Lock Duration | 15 minutes |
| Signature Validity | 24 hours |

---

## ğŸ› ï¸ Technology Stack

### Backend Technologies
- **Node.js** v20+ Runtime
- **Express.js** v4.18 Framework
- **PostgreSQL** Database
- **Prisma** v5.3 ORM
- **JWT** Authentication
- **Passport.js** OAuth
- **Puppeteer** PDF Generation
- **Nodemailer** Email
- **Helmet.js** Security

### Frontend Technologies
- **Next.js** v16 Framework
- **React** v19.1 Library
- **TypeScript** v5 Language
- **Tailwind CSS** v4 Styling
- **Zustand** v5 State Management
- **MapTiler** v3.8 Maps
- **Swiper** v12 Carousel

### Mobile Technologies
- **Capacitor** v8 Framework
- **Android** Native APK
- **Deep Linking** URL Scheme

### Cloud Services
- **Vercel** Frontend Hosting
- **Render** Backend Hosting
- **Supabase** PostgreSQL Database
- **Cloudinary** Media CDN
- **Resend** Email API

### DevSecOps & CI/CD
- **GitHub Actions** CI/CD Pipeline
- **ESLint** SAST Linting
- **CodeQL** Security Analysis
- **Gitleaks** Secret Detection
- **Trivy** Vulnerability Scan

---

## âš–ï¸ Intellectual Property & Ownership

### Proprietary Rights

All deliverables, including source code, algorithms, designs, and documentation ("Work Product") are the exclusive property of **Metairflow R&D Sdn. Bhd.**

### Usage Restrictions

- Submitted as part of **Mobile SecOps 21 Days Challenge**
- Unauthorized reproduction or commercial use prohibited for **24 months**

### Confidentiality

This repository adheres to the **Non-Disclosure Agreement (NDA)**. Obligations remain effective for **three (3) years** after engagement ends.

### Licensing Compliance

All third-party libraries used are compliant with their respective licenses (MIT, Apache 2.0).

---

<div align="center">
  <p><i>Built with â¤ï¸ by Team Vecna for Mobile SecOps Challenge 2025</i></p>
  <p><i>Â© 2025 Metairflow R&D Sdn. Bhd.</i></p>
  <p><i>Governed by the laws of Malaysia (Copyright Act 1987)</i></p>
</div>